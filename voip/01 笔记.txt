IP 电话：在 IP 网上传送的具有一定质量的语音业务
	采用技术：VoIP（Voice over IP），IP 上传送话音（采用分组技术传送的语音业务）

分组网络传输语音的方式：
	1）帧中继语音技术
	2）ATM 语音技术
	3）IP 语音技术（应用最为广泛）

电话业务类型：
	1）PC 到 PC：PC - Internet - PC（IP 语音软件，如：MSN）
	2）PC 到 电话：PC - Internet - Gateway（信令转换、IP 数据包语音转换为电路上的语音信号） - Phone
	3）电话到电话：Phone - PSTN/ISDN - Gaeway - Internet - Gateway - PSTN/ISDN - Phone，发展最快，最有商业化前途
	4）电话到 PC：给 PC 机分配有关电话号码
2、3 应用较多

网关：IP 电话网的接入设备，位于电话交换网与 IP 网之间，是电话交换网的终结点，也是 IP（分组）交换网的起始点，为用户提供 IP 电话业务，完成信令转换及媒体转换

网守：IP 电话网的管理设备，提供地址解析、接入认证、带宽管理和资源管理等功能
	地址解析：利用主叫所拨的普通电话号码查询被叫所在的网关的 IP 地址以及有关的端口号码
	接入认证：接入网关的权限进行认证

网关和网守之间采用注册、许可和状态协议 RAS

网守与计费认证中心之间采用授权、认证和计费的标准协议 RADIUS

网关和网守之间的信令协议：呼叫控制协议 H.225.0（Q.931）和媒体通信控制协议 H.245

网关和网关之间的音频信号采用 IP 数据包传送，音频编码可采用 G.711（64k/s）（ATM）、G.729A（8k/s）和 G.723.1（5.3/6.3kb/s）

网关和网守、网关与网关之间的信息都是在因特网上传送的，网络层协议采用 IP 协议，传输层协议采用 TCP（H.225（Q.931）、H.245）或 UDP（RAS、RTP），音频信息采用实时控制协议 RTP 封装后用数据报协议 UDP 传送

IP 电话通信的一般过程：
计费认证中心：各公司在发卡前已经通过受理终端将相应的计费信息和卡的数据输入计费服务器和用户数据库
->
用户通过普通电话拨某公司的接入号，交换机判别这是一个 IP 电话二次拨号业务及该接入号所属的电信公司，就通过电话网的信令建立到所属公司的 IP 电话网关的话音通路，将该话机接入 IP 电话网关
->
网关通过话音通路向用户送提示音，要求选择语言。用户按录音提示选择提示语言后（一般提供普通话和英文的选择），再根据语音提示输入卡号和密码（用户必须使用双音多频拨号方式）
->
网关处理后将呼叫请求和卡号、密码等用 RAS 信息上传到网守
->
网守处理后将相关信息用 Radius 协议传送到后台计费认证服务器。通过认证后，计费/认证服务器用 Radius 信息通知网守
->
网守用 RAS 消息将认证结果通知主叫所在的网关
->
网关通过话音通路向用户送提示音，要求输入被叫号码，用户按照录音提示输入被叫号码，被叫号码通过话音通路传送到 IP 电话网关
->
网关处理后将被叫号码等用 RAS 信息上传到网守，请求地址解析。网守分析被叫号码，将其翻译为被叫所在网关的呼叫信令信道地址，并用 RAS 消息会送地址解析结果给主叫所在网关
->
两个网关之间采用 Q.931 消息进行协商建立话路，采用 H.245 协议建立逻辑通道，并在此逻辑通道上传送语音分组

IP 话音分组的基本处理过程：
从电话机发出的语音信号是模拟波形
->
数字交换机的用户电路要对语音信号进行模数转换，将模拟信号转换为数字信号（PCM 编码）。目前采用的语音编码标准是 ITU-T 的 G.711，数码率是 64kb/s，交换机将话音信号的 PCM 编码传送给网关
->
网关对 PCM 语音包以特定的帧长进行压缩编码，然后将压缩的语音包送入网络处理器。网络处理器为语音包添加包头、时标（时戳）和其他信息后形成语音包
->
IP 网络把数据放在可变长的数据报或分组中，然后给每个数据报附带寻址和控制信息，并通过网络发送，一站一站地转发到目的地。
网络中的中间节点检查每个 IP 数据报附带的寻址信息，并使用这个信息把该数据报转发到目的地路径上的下一站
->
网关：目的地 VoIP 设备接收这个 IP 数据报并开始处理。网络级提供一个可变长度的缓冲器，用来调节网络产生的抖动。在数据报的处理过程中，去掉寻址和控制信息，然后把语音数据提供给解码器。解码器将压缩编码转换为连续的 PCM 编码后传送给交换机
->
PSTN：数字交换机的用户电路将 PCM 编码转换为模拟的话音电流送给电话机

IP 电话的关键技术：
	1）话音处理技术：
		尽可能降低编码比特率（话音编码技术、静音检测），减少带宽
		保证一定的通话质量（分组丢失补偿、消除抖动和回拨抵消技术）

选择话音编码算法需要考虑的因素：编码比特率、话音质量、时延、算法复杂度

低比特率话音编码：
	PSTN 广泛应用 PCM 话音编码（波形编码技术，比特率为 64kbit/s）
	IP 电话采用参数编码技术（G.729(G.729a) 8kbit/s、G.723(G.723.1) 5.3/6.3kbit/s）

静音检测：静音时不发送数据包
分组丢失补偿
回波抵消：电话中听到自己声音的现象，普通电话电路上存在二次通话，由网关设备解决
处理话音时延抖动的技术

IP 话音通信协议：
	话音通信控制协议：ITU-T的 H.323 系列、IETF 的会话初始化协议（SIP）

H.323 呼叫建立过程涉及的三种信令：H.323.jpeg
	RAS（注册：Registration、许可：Admission 和状态：Status）信令用来完成终端与网守之间的等级注册、授权许可、带宽改变、状态和脱离接触等过程
	H.225.0 呼叫信令用来建立两个终端之间的连接，这个信令使用 Q.931 消息来控制呼叫的建立和拆除，当系统中没有网守时，呼叫信令信道在呼叫涉及的两个终端之间打开；当系统中包含一个网守时，由网守决定在终端与网守之间或是在两个终端之间建立呼叫空盒子信令信道
	H.245 控制信令用来传送终端到终端的媒体控制消息，包括主从判别、能力交换、打开和关闭逻辑信道、模式参数请求、流控消息等

SIP 是 IETF 定义的会话初始化协议
	会话初始化协议 SIP
	会话描述协议 SDP

话音信息传送协议：规定了话音分组应如何封装、复用和传送，包括具有静音检测功能的各种话音编码分组如何组装和标识。由于话音分组需要实时传送，不允许有大的时延，因此无法采用重发纠错机制。话音分组代用 UDP 作为运输层的协议

实时控制协议：IETF 定义了试试传输协议 RTP（Real Time Protol）支持语音、视频等实时信息的传送
	RTP 报头中包含装载数据的标识符、序列号、时间戳一斤传送监视等，可以让接收端重组接收到的数据分组
	RTCP 协议提供接收端到发送端端的服务质量反馈
	IP 网路电话利用 RTP 协议来适配分组话音数据

安全技术：身份认证（authentication）
	对使用该业务的用户的身份是否合法进行认证
	对于卡号业务，一般是在呼叫开始前对用户的账号和密码进行认证，一些特定用户可以使用已授权的专用的线路进行 IP 电话呼叫，身份认证是通过静态密钥的配置完成的
	身份认证不仅发生在用户和系统时间，在规模较大的商用网络里，下级设备在初次向上级设备注册时也需要身份认证

授权：
	对用户的接入进行控制。同一用户可能开发不同的业务，系统在对用户的身份认证通过后，确定哪些业务对该用户开放的，并给予授权。
	授权不仅发生在用户和系统时间，在规模较大的商用网络里，下级设备在初次向上级设备注册时也需要身份认证

加密：在 IP 电话系统中，需要对关键的数据进行加密，加密的目的是防止不相关的人员得到这些信息的内容，如用户的资料、密码、呼叫控制信令的一些内容等
不可抵赖性保护：在相关网络部件（如网关和服务器）中必须保存关于呼叫的完整记录，以防止某些用户使用过网络服务后抵赖
数据完整性：有些业务中发生的数据并不要求实现加密，因为这要增加大量的开销，但必须保证相应信息不能被未授权的人修改，如用户的计费数据

QoS 保障技术：
对服务质量的要求：
	传统 IP 网络主要用来传输数据业务，采用尽力而为、无连接的技术，没有服务质量保证，存在分组丢失、失序到达和时延抖动等情况。对于分组丢失或传输错误，数据业务可采用重发解决
	语音是实时业务，对时延、时序等有严格的要求，必须采取特殊措施保障一定的业务质量

提高服务质量的措施：资源预留协议（RSVP）、区分服务、多协议标记交换 MPLS、超量工作法
































